<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="./create.js"></script>
    <script src="./dragDrop.js"></script>
    <script src="./utils.js"></script>
    <script src="./jogadas.js"></script>
</head>

<body>

    <div class="tabuleiro">
    </div>
    <script>
        let movimentos = [];
        let movimentosNoCheck = [];
        /*
        $create.init(true);
        */
        $create.init();
        $('.casa[data-pos="2-4"]').html($create.html('clara', new Date().getTime(), 'rei', "2-4", 'grande'));
        $('.casa[data-pos="2-1"]').html($create.html('clara', new Date().getTime(), 'peao', "2-1", ''));
        $('.casa[data-pos="2-8"]').html($create.html('escura', new Date().getTime(), 'torre', "2-8", 'medio'));
        
        $(document).on('mousedown', '.peca', function () {
            resetMovs();
            movimentos = [];            // TODO MOVIMENTOS POSSIVEIS
            movimentosNoCheck = [];     // MOVIMENTOS POSSIVEIS CASO PECA QUE PROTEGE O REI
            $jogadas[$(this).attr('data-tipo')](this, true);
            $setCasas(movimentos);
            if (movimentos.length)
                $(this).closest(`.casa`).addClass('on');
        });


        //GAMBI INSERE PECAS
        let corDefault = 'clara';
        $(document).on('keydown', '.casa', function (e) {
            if (e.keyCode == 46)
                return $(this).empty();
            if (e.keyCode == 104) {
                corDefault = corDefault == 'clara' ? 'escura' : 'clara';
                return;
            }

            if (![97, 98, 99, 100, 101, 102,].includes(e.keyCode)) return;

            let tipo = e.keyCode == 97
                ? 'rei'
                : e.keyCode == 98
                    ? 'rainha'
                    : e.keyCode == 99
                        ? 'torre'
                        : e.keyCode == 100
                            ? 'cavalo'
                            : e.keyCode == 101
                                ? 'bispo'
                                : 'peao';

            $(this).html($create.html(corDefault, new Date().getTime(), tipo, $(this).data('pos'), 'medio'));
        });

        /*
            * bloquear movimento rei pro lado oposto da peça(torre, bispo, rainha)
            * Peão andar 2 primeira mexida - podendo ser comido nas duas casas
            * Cria Regras do jogo
            * 
            BRINCAR COM CLASS TABULEIRO
                transform: perspective(1em) rotateX(50deg); 
                transform: perspective(50em) rotateX(50deg);
                transition: all 200ms;

                PECAS https://br.freepik.com/
        */
    </script>
</body>

</html>