<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="style/menu.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="./create.js"></script>
    <script src="./dragDrop.js"></script>
    <script src="./utils.js"></script>
    <script src="./jogadas.js"></script>
</head>

<body>
    <div class="content">
        <div class="jogo">
            <div class="tabuleiro"></div>
        </div>
        <div class="menu">
            <div>
                <ul class="settings">
                    <li><input type="checkbox" checked data-tipo="movimentos" onchange="ajudas(this)" id="">Movimentos</li>
                    <li><input type="checkbox" checked data-tipo="ultimoMovimento" onchange="ajudas(this)" id="">Ultimos
                        Movimentos</li>
                    <li><input type="checkbox" checked data-tipo="ultimoMovimentoClick" onchange="ajudas(this)" id="">Ultimos
                        Movimentos Persistir</li>
                    <li><input type="checkbox" checked data-tipo="selected" onchange="ajudas(this)" id="">Peca
                        selecionada</li>
                </ul>
            </div>
            <div class="historico">
                <div class="brancas">
                    Brancas
                    <div class="jogadas"></div>
                </div>
                <div class="negras">
                    Negras
                    <div class="jogadas"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function start() {
            $('.tabuleiro').toggleClass('off')
        }
        let settings = {
            ajudas: {
                movimentos: true,
                ultimoMovimento: true,
                ultimoMovimentoClick: true,
                selected: true,
                check: true
            },
            game: {
                xeque: null,
                jogadorVez: 'branca',
                jogador1: {
                    cor: 'branca'
                },
                jogador2: {
                    cor: 'preta'
                }
            }
        }

        function ajudas(obj) {
            settings.ajudas[$(obj).data('tipo')] = $(obj).prop('checked');
        }

        let movimentos = [];
        let movimentosNoCheck = [];
        /*
        $create.init(true);
        */
        $create.init();
        $('.casa[data-pos="2-4"]').html($create.html('clara', new Date().getTime(), 'rei', "2-4", 'grande'));
        $('.casa[data-pos="2-1"]').html($create.html('clara', new Date().getTime(), 'peao', "2-1", ''));
        $('.casa[data-pos="4-8"]').html($create.html('escura', new Date().getTime(), 'torre', "4-8", 'medio'));

        $(document).on('mousedown', '.peca', function () {
            resetMovs();
            movimentos = [];            // TODO MOVIMENTOS POSSIVEIS
            movimentosNoCheck = [];     // MOVIMENTOS POSSIVEIS CASO PECA QUE PROTEGE O REI
            $jogadas[$(this).attr('data-tipo')](this, true);
            $setCasas(movimentos);
            if (movimentos.length && settings.ajudas.selected)
                $(this).closest(`.casa`).addClass('on');
        });


        //GAMBI INSERE PECAS
        let corDefault = 'clara';
        $(document).on('keydown', '.casa', function (e) {
            if (e.keyCode == 46)
                return $(this).empty();
            if (e.keyCode == 104) {
                corDefault = corDefault == 'clara' ? 'escura' : 'clara';
                return;
            }

            if (![97, 98, 99, 100, 101, 102,].includes(e.keyCode)) return;

            let tipo = e.keyCode == 97
                ? 'rei'
                : e.keyCode == 98
                    ? 'rainha'
                    : e.keyCode == 99
                        ? 'torre'
                        : e.keyCode == 100
                            ? 'cavalo'
                            : e.keyCode == 101
                                ? 'bispo'
                                : 'peao';

            $(this).html($create.html(corDefault, new Date().getTime(), tipo, $(this).data('pos'), 'medio'));
        });

        /*
            * Pe√£o andar 2 primeira mexida - podendo ser comido nas duas casas
            * Roque
            * Cria Regras do jogo

            https://br.freepik.com/
        */
    </script>
</body>

</html>